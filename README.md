# 音频分割工具

这是一个基于Python和FFmpeg的音频分割工具，可以根据用户设定的要求自动分割音频文件。

## 功能特点

1. **图形界面**：提供简单易用的GUI界面
2. **批量处理**：支持批量处理文件夹中的所有音频文件
3. **智能分割**：按照用户指定的时长自动分割音频
4. **语音优化**：自动去除非人声部分
5. **高级平滑结束**：每个音频片段末尾添加高级淡出效果，避免生硬结束
6. **自动过滤**：自动丢弃时长不足的音频片段
7. **输出路径自定义**：可选择处理结果保存位置
8. **快捷打开**：一键打开输出文件夹查看结果
9. **跨平台支持**：同时支持Windows和macOS系统
10. **参数持久化**：自动保存用户设置，下次启动时自动恢复

## 环境要求

- Python 3.6+
- FFmpeg

## 安装说明

### 1. 安装Python
确保系统已安装Python 3.6或更高版本。

### 2. 安装FFmpeg

**Windows:**
1. 访问 https://www.gyan.dev/ffmpeg/builds/
2. 下载完整版本的FFmpeg
3. 解压到目录并添加到系统PATH环境变量

**macOS:**
```bash
brew install ffmpeg
```

**Ubuntu/Debian:**
```bash
sudo apt update && sudo apt install ffmpeg
```

### 3. 克隆项目
```bash
git clone <repository-url>
cd cup-audio
```

## 使用方法

1. 运行程序：
   ```bash
   python audio_splitter.py
   ```

2. 在GUI界面中：
   - 点击"浏览"选择包含音频文件的文件夹
   - 设置分割时长（秒）
   - 选择是否启用高级音频处理
   - 可选：点击输出路径旁的"浏览"按钮选择自定义输出文件夹
   - 点击"开始处理"
   - 处理完成后，可通过"打开文件夹"按钮快速查看结果

3. 处理完成后，分割后的音频文件将保存在指定的输出文件夹中

4. 下次启动程序时，之前的设置将自动恢复

## 处理流程

1. **去除非人声**：使用FFmpeg的silenceremove滤镜去除非人声部分
2. **按时长分割**：按照用户设定的时长分割音频
3. **高级平滑结束**：为每个片段添加高级淡出效果，包括：
   - 指数衰减曲线淡出
   - 更自然的音频结束处理
4. **过滤短片段**：自动丢弃时长不足的片段

## 高级处理功能

启用高级音频处理后，工具将应用以下增强功能：

1. **智能去除非人声**：更精确地识别和去除非人声部分
2. **高级淡出算法**：使用指数衰减曲线而非线性淡出，使音频结束更加自然
3. **平滑过渡处理**：确保音频片段结束时不会有突兀感

## 参数持久化

工具会自动保存以下用户设置：
- 音频文件夹路径
- 分割时长
- 高级处理选项状态
- 输出文件夹路径
- 窗口大小和位置

配置文件位置：
- **Windows**: `%APPDATA%\AudioSplitter\config.json`
- **macOS**: `~/Library/Application Support/AudioSplitter/config.json`
- **Linux**: `~/.config/audiosplitter/config.json`

## 问题修复记录

### v1.3 参数持久化功能
- 实现了所有GUI参数的自动保存和恢复
- 添加了跨平台的配置文件管理
- 增强了用户体验，无需每次重新设置参数

### v1.2 跨平台兼容性增强
- 为输出路径添加了浏览按钮，可自定义输出文件夹
- 增强了Windows和macOS系统的兼容性
- 清理了项目中不必要的测试文件

### v1.1 修复音频分割问题
- 修复了分割后的音频只有第一秒有声音的问题
- 优化了FFmpeg参数，确保完整音频片段被正确提取
- 改进了淡出效果的应用方式

### v1.0 初始版本
- 基本音频分割功能
- GUI界面操作
- 高级音频处理选项

## 支持的音频格式

- MP3
- WAV
- FLAC
- AAC
- OGG
- M4A

## 注意事项

- 请确保FFmpeg已正确安装并添加到系统PATH
- 处理大文件时可能需要较长时间，请耐心等待
- 输出文件格式为WAV，以确保兼容性和处理质量
- 启用高级处理功能会增加处理时间，但会提供更好的音频质量
- 处理完成后可通过界面按钮快速打开输出文件夹